"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[725],{847:(e,s,t)=>{t.d(s,{Z:()=>c});t(2791);var a=t(184);const c=e=>{let{children:s,navigationClass:t="origin"}=e;return(0,a.jsx)("div",{className:"Navigation ".concat(t),children:s})}},9742:(e,s,t)=>{t.r(s),t.d(s,{default:()=>E});var a=t(5338),c=t(847),i=t(2791),r=t(4122),n=t(187),o=t(7563),d=t(4397),l=t(1731),m=t(9934),u=t(9179);var _=t(8079),b=t(184);const k=e=>{let{value:s=0,change:t,classAmount:a="origin",max:c=1e3,min:i=1}=e;return(0,b.jsxs)("div",{className:"Amount ".concat(a),children:[(0,b.jsx)("div",{onClick:()=>(e=>{const s=Math.min(c,e+1);t(s)})(s),className:"Amount__change _plus"}),(0,b.jsx)("div",{className:"Amount__number",children:s}),(0,b.jsx)("div",{onClick:()=>(e=>{const s=Math.max(i,e-1);t(s)})(s),className:"Amount__change _minus"})]})},h=e=>{let{e:s,products:t,basketId:a}=e;const[c,d]=(0,i.useState)(0),{sumPrice:l}=(0,r.C)((e=>e.reducer.basket)),{setSumPrice:h}=n.basketSlice.actions,v=(0,r.T)();(0,i.useEffect)((()=>{d(s.count),console.log(s.product.price,l)}),[]);const x=(e,s)=>{v(((e,s,t)=>async a=>{const c=u.h.getState(),{sumPrice:i}=c.reducer.basket,{setSumPrice:r}=n.basketSlice.actions;try{a(r(i-t*e.product.price+s*e.product.price)),await(0,o.Yv)({id:e._id,count:s})}catch(d){console.log(d)}})(e,s,c)),d(s)};return(0,b.jsxs)("div",{className:"items-basket__product",children:[(0,b.jsx)("div",{className:"items-basket__image-flex",children:(0,b.jsx)("div",{className:"items-basket__image-cover",children:(0,b.jsx)("div",{className:"items-basket__image",children:(0,b.jsx)("img",{src:"".concat(_.T5,"/").concat(s.product.name,"/").concat(JSON.parse(s.product.images)[0]),alt:""})})})}),(0,b.jsxs)("div",{className:"items-basket__info",children:[(0,b.jsx)("div",{className:"items-basket__name",children:s.product.name}),(0,b.jsx)("div",{className:"items-basket__brand",children:s.product.brand.name})]}),(0,b.jsxs)("div",{className:"items-basket__price",children:[s.product.price," \u0420"]}),(0,b.jsx)("div",{className:"items-basket__amount amount-basket",children:(0,b.jsx)(k,{value:c,change:e=>x(s,e),classAmount:"basket"})}),(0,b.jsxs)("div",{className:"items-basket__total",children:[s.product.price*c," \u0420"]}),(0,b.jsx)("div",{onClick:()=>{v(((e,s,t)=>async a=>{const c=u.h.getState(),{sumPrice:i}=c.reducer.basket,r=c.reducer.navbar,{basket:d}=c.reducer.basket,{setSumPrice:l,setBasket:_}=n.basketSlice.actions,b=m.navbarSlice.actions;try{a(_({...d,basketItems:d.basketItems.filter((s=>s._id!==e._id))})),a(l(i-e.product.price*s)),a(b.setProducts(r.products-1)),await(0,o.ff)({id:e.product._id,basketId:t})}catch(k){console.log(k)}})(s,c,a))},className:"items-basket__delete _icon-delete"})]})};var v=t(255),x=t(6674);const j=()=>{const{user:e}=(0,r.C)((e=>e.reducer.catalog)),{basket:s}=(0,r.C)((e=>e.reducer.basket)),{setSumPrice:t}=n.basketSlice.actions,a=(0,r.T)();return(0,i.useEffect)((()=>{const e=s.basketItems.reduce(((e,s)=>{var t;return(null===s||void 0===s||null===(t=s.product)||void 0===t?void 0:t.price)*s.count+e}),0);a(t(e))}),[]),(0,b.jsx)("div",{className:"items-basket__body",children:(0,b.jsx)(v.Z,{className:"todo-list",children:s.basketItems.map((t=>(0,b.jsx)(x.Z,{timeout:500,classNames:"item",children:(0,b.jsx)(h,{e:t,products:s,basketId:e.basket})},t._id)))})})};var p=t(7181);const N="bottomItems_totalPriceBasket__uCl+B",f="bottomItems_left__v2rJx",g="bottomItems_right__NoVNL",S="bottomItems_buttonCart__qo8yX",y="bottomItems_bottom__DDumw",I="bottomItems_submit__z5Akx",C=()=>{const{sumPrice:e}=(0,r.C)((e=>e.reducer.basket)),s=(0,r.T)();return(0,b.jsxs)("div",{className:y,children:[(0,b.jsx)("div",{className:I,children:(0,b.jsx)(p.Z,{onClick:()=>s((async e=>{const s=u.h.getState(),{user:t}=s.reducer.catalog,{sumPrice:a,products:c}=s.reducer.basket,{setProducts:i}=m.navbarSlice.actions,{setLoad:r}=n.basketSlice.actions;try{e(r(!0)),e(i(0));const s=await(0,o.fk)({id:t.id});let n=[];for(const e of s.basketItems)n=[...n,{[e.product._id]:e.count}];await(0,o.fS)({ordersId:t.orders,price:a,products:JSON.stringify(n)});for(const e of c)await(0,d.m)({id:Object.keys(e)[0],purchase:1});await(0,o.xY)({id:t.basket}),window.location.replace(l.Kt)}catch(_){console.log(_)}})),className:S,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})}),(0,b.jsxs)("div",{className:N,children:[(0,b.jsx)("div",{className:f,children:"\u0418\u0442\u043e\u0433\u043e:"}),(0,b.jsxs)("div",{className:g,children:[e," \u0420"]})]})]})},P=["\u0424\u043e\u0442\u043e","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435","\u0426\u0435\u043d\u0430","\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e","\u0418\u0442\u043e\u0433\u043e"],w=()=>(0,b.jsx)("div",{className:"items-basket__top top-basket",children:P.map((e=>(0,b.jsx)("div",{className:"top-basket__item",children:e},e)))}),B=()=>(0,b.jsxs)("div",{className:"Basket__items items-basket",children:[(0,b.jsx)(w,{}),(0,b.jsx)(j,{}),(0,b.jsx)(C,{})]}),O=()=>(0,b.jsxs)("div",{className:"Basket__topic",children:[(0,b.jsx)("div",{className:"Basket__title",children:"\u041a\u043e\u0440\u0437\u0438\u043d\u0430"}),(0,b.jsx)(B,{})]});var Z=t(77);const A=()=>{const{basket:e,load:s}=(0,r.C)((e=>e.reducer.basket)),t=(0,r.T)();return(0,i.useEffect)((()=>{t((async e=>{const s=u.h.getState(),{user:t}=s.reducer.catalog,{setProducts:a,setBasket:c,setLoad:i}=n.basketSlice.actions;try{e(i(!0));const s=await(0,o.fk)({id:t.id});e(c(s));let r=[];for(const e of s.basketItems)r=[...r,{[e.product._id]:e.count}];e(a(r))}catch(r){console.log(r)}finally{e(i(!1))}}))}),[]),(0,b.jsx)(b.Fragment,{children:s?(0,b.jsx)(Z.Z,{}):e&&0!==e.basketItems.length?(0,b.jsx)(O,{}):(0,b.jsx)("div",{className:"Basket__none _icon-cart",children:"\u043d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"})})},T=()=>(0,b.jsx)("div",{className:"Basket",children:(0,b.jsx)("div",{className:"Basket__container",children:(0,b.jsxs)("div",{className:"Basket__body",children:[(0,b.jsx)(c.Z,{navigationClass:"basket",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f / \u041a\u043e\u0440\u0437\u0438\u043d\u0430"}),(0,b.jsx)(A,{})]})})}),E=()=>(0,b.jsx)(a.Z,{children:(0,b.jsx)(T,{})})},7462:(e,s,t)=>{function a(){return a=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},a.apply(this,arguments)}t.d(s,{Z:()=>a})},3366:(e,s,t)=>{function a(e,s){if(null==e)return{};var t,a,c={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],s.indexOf(t)>=0||(c[t]=e[t]);return c}t.d(s,{Z:()=>a})}}]);
//# sourceMappingURL=725.dba222ac.chunk.js.map