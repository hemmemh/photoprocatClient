"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[742],{847:(e,s,t)=>{t.d(s,{Z:()=>c});t(2791);var a=t(184);const c=e=>{let{children:s,navigationClass:t="origin"}=e;return(0,a.jsx)("div",{className:"Navigation ".concat(t),children:s})}},9742:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Z});var a=t(5338),c=t(847),i=t(2791),r=t(4122),o=t(187),n=t(7563),d=t(4397),l=t(1731),m=t(9934),u=t(9179);var _=t(8079),k=t(184);const b=e=>{let{value:s=0,change:t,classAmount:a="origin",max:c=1e3,min:i=1}=e;return(0,k.jsxs)("div",{className:"Amount ".concat(a),children:[(0,k.jsx)("div",{onClick:()=>(e=>{const s=Math.min(c,e+1);t(s)})(s),className:"Amount__change _plus"}),(0,k.jsx)("div",{className:"Amount__number",children:s}),(0,k.jsx)("div",{onClick:()=>(e=>{const s=Math.max(i,e-1);t(s)})(s),className:"Amount__change _minus"})]})},h=e=>{let{e:s,products:t,basketId:a}=e;const[c,d]=(0,i.useState)(0),{sumPrice:l}=(0,r.C)((e=>e.reducer.basket)),{setSumPrice:h}=o.basketSlice.actions,x=(0,r.T)();(0,i.useEffect)((()=>{d(s.count),console.log(s.product.price,l)}),[]);const v=(e,s)=>{x(((e,s,t)=>async a=>{const c=u.h.getState(),{sumPrice:i}=c.reducer.basket,{setSumPrice:r}=o.basketSlice.actions;try{a(r(i-t*e.product.price+s*e.product.price)),await(0,n.Yv)({id:e._id,count:s})}catch(d){console.log(d)}})(e,s,c)),d(s)};return(0,k.jsxs)("div",{className:"items-basket__product",children:[(0,k.jsx)("div",{className:"items-basket__image-flex",children:(0,k.jsx)("div",{className:"items-basket__image-cover",children:(0,k.jsx)("div",{className:"items-basket__image",children:(0,k.jsx)("img",{src:"".concat(_.T5,"/").concat(s.product.name,"/").concat(JSON.parse(s.product.images)[0]),alt:""})})})}),(0,k.jsxs)("div",{className:"items-basket__info",children:[(0,k.jsx)("div",{className:"items-basket__name",children:s.product.name}),(0,k.jsx)("div",{className:"items-basket__brand",children:s.product.brand.name})]}),(0,k.jsxs)("div",{className:"items-basket__price",children:[s.product.price," \u0420"]}),(0,k.jsx)("div",{className:"items-basket__amount amount-basket",children:(0,k.jsx)(b,{value:c,change:e=>v(s,e),classAmount:"basket"})}),(0,k.jsxs)("div",{className:"items-basket__total",children:[s.product.price*c," \u0420"]}),(0,k.jsx)("div",{onClick:()=>{x(((e,s,t)=>async a=>{const c=u.h.getState(),{sumPrice:i}=c.reducer.basket,r=c.reducer.navbar,{basket:d}=c.reducer.basket,{setSumPrice:l,setBasket:_}=o.basketSlice.actions,k=m.navbarSlice.actions;try{a(_({...d,basketItems:d.basketItems.filter((s=>s._id!==e._id))})),a(l(i-e.product.price*s)),a(k.setProducts(r.products-1)),await(0,n.ff)({id:e.product._id,basketId:t})}catch(b){console.log(b)}})(s,c,a))},className:"items-basket__delete _icon-delete"})]})},x=()=>{const{user:e}=(0,r.C)((e=>e.reducer.catalog)),{basket:s}=(0,r.C)((e=>e.reducer.basket)),{setSumPrice:t}=o.basketSlice.actions,a=(0,r.T)();return(0,i.useEffect)((()=>{const e=s.basketItems.reduce(((e,s)=>{var t;return(null===s||void 0===s||null===(t=s.product)||void 0===t?void 0:t.price)*s.count+e}),0);a(t(e))}),[]),(0,k.jsx)("div",{className:"items-basket__body",children:s.basketItems.map((t=>(0,k.jsx)(h,{e:t,products:s,basketId:e.basket},t._id)))})};var v=t(7181);const j="bottomItems_totalPriceBasket__uCl+B",p="bottomItems_left__v2rJx",N="bottomItems_right__NoVNL",g="bottomItems_buttonCart__qo8yX",f="bottomItems_bottom__DDumw",S="bottomItems_submit__z5Akx",I=()=>{const{sumPrice:e}=(0,r.C)((e=>e.reducer.basket)),s=(0,r.T)();return(0,k.jsxs)("div",{className:f,children:[(0,k.jsx)("div",{className:S,children:(0,k.jsx)(v.Z,{onClick:()=>s((async e=>{const s=u.h.getState(),{user:t}=s.reducer.catalog,{sumPrice:a,products:c}=s.reducer.basket,{setProducts:i}=m.navbarSlice.actions,{setLoad:r}=o.basketSlice.actions;try{e(r(!0)),e(i(0));const s=await(0,n.fk)({id:t.id});let o=[];for(const e of s.basketItems)o=[...o,{[e.product._id]:e.count}];await(0,n.fS)({ordersId:t.orders,price:a,products:JSON.stringify(o)});for(const e of c)await(0,d.m)({id:Object.keys(e)[0],purchase:1});await(0,n.xY)({id:t.basket}),window.location.replace(l.Kt)}catch(_){console.log(_)}})),className:g,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})}),(0,k.jsxs)("div",{className:j,children:[(0,k.jsx)("div",{className:p,children:"\u0418\u0442\u043e\u0433\u043e:"}),(0,k.jsxs)("div",{className:N,children:[e," \u0420"]})]})]})},C=["\u0424\u043e\u0442\u043e","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435","\u0426\u0435\u043d\u0430","\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e","\u0418\u0442\u043e\u0433\u043e"],y=()=>(0,k.jsx)("div",{className:"items-basket__top top-basket",children:C.map((e=>(0,k.jsx)("div",{className:"top-basket__item",children:e},e)))}),P=()=>(0,k.jsxs)("div",{className:"Basket__items items-basket",children:[(0,k.jsx)(y,{}),(0,k.jsx)(x,{}),(0,k.jsx)(I,{})]}),w=()=>(0,k.jsxs)("div",{className:"Basket__topic",children:[(0,k.jsx)("div",{className:"Basket__title",children:"\u041a\u043e\u0440\u0437\u0438\u043d\u0430"}),(0,k.jsx)(P,{})]});var B=t(77);const A=()=>{const{basket:e,load:s}=(0,r.C)((e=>e.reducer.basket)),t=(0,r.T)();return(0,i.useEffect)((()=>{t((async e=>{const s=u.h.getState(),{user:t}=s.reducer.catalog,{setProducts:a,setBasket:c,setLoad:i}=o.basketSlice.actions;try{e(i(!0));const s=await(0,n.fk)({id:t.id});e(c(s));let r=[];for(const e of s.basketItems)r=[...r,{[e.product._id]:e.count}];e(a(r))}catch(r){console.log(r)}finally{e(i(!1))}}))}),[]),(0,k.jsx)(k.Fragment,{children:s?(0,k.jsx)(B.Z,{}):e&&0!==e.basketItems.length?(0,k.jsx)(w,{}):(0,k.jsx)("div",{className:"Basket__none _icon-cart",children:"\u043d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"})})},T=()=>(0,k.jsx)("div",{className:"Basket",children:(0,k.jsx)("div",{className:"Basket__container",children:(0,k.jsxs)("div",{className:"Basket__body",children:[(0,k.jsx)(c.Z,{navigationClass:"basket",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f / \u041a\u043e\u0440\u0437\u0438\u043d\u0430"}),(0,k.jsx)(A,{})]})})}),Z=()=>(0,k.jsx)(a.Z,{children:(0,k.jsx)(T,{})})}}]);
//# sourceMappingURL=742.65863f1a.chunk.js.map