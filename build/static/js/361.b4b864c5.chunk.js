"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[361],{847:(e,s,t)=>{t.d(s,{Z:()=>c});t(2791);var a=t(184);const c=e=>{let{children:s,navigationClass:t="origin"}=e;return(0,a.jsx)("div",{className:"Navigation ".concat(t),children:s})}},1966:(e,s,t)=>{t.r(s),t.d(s,{default:()=>P});var a=t(5338),c=t(847),i=t(2791),r=t(4122),n=t(187),o=t(7563),d=t(4397),l=t(1731),m=t(9934),u=t(9179);var k=t(8079),b=t(184);const _=e=>{let{value:s=0,change:t,classAmount:a="origin",max:c=1e3,min:i=1}=e;return(0,b.jsxs)("div",{className:"Amount ".concat(a),children:[(0,b.jsx)("div",{onClick:()=>{(e=>{const s=Math.min(c,e+1);t(s)})(s)},className:"Amount__change _plus"}),(0,b.jsx)("div",{className:"Amount__number",children:s}),(0,b.jsx)("div",{onClick:()=>{(e=>{const s=Math.max(i,e-1);t(s)})(s)},className:"Amount__change _minus"})]})},h=e=>{let{basketItem:s,basketId:t}=e;const[a,c]=(0,i.useState)(0),d=(0,r.T)();(0,i.useEffect)((()=>{c(s.count)}),[]);const l=(0,i.useCallback)((e=>{d(((e,s,t)=>async a=>{const c=u.h.getState(),{sumPrice:i}=c.reducer.basket,{setSumPrice:r}=n.basketSlice.actions;try{a(r(i-t*e.product.price+s*e.product.price)),await(0,o.Yv)({id:e._id,count:s})}catch(d){console.log(d)}})(s,e,a)),c(e)}),[a]),h=(0,i.useCallback)((()=>{d(((e,s,t)=>async a=>{const c=u.h.getState(),{sumPrice:i}=c.reducer.basket,r=c.reducer.navbar,{basket:d}=c.reducer.basket,{setSumPrice:l,setBasket:k}=n.basketSlice.actions,b=m.navbarSlice.actions;try{a(k({...d,basketItems:d.basketItems.filter((s=>s._id!==e._id))})),a(l(i-e.product.price*s)),a(b.setProducts(r.products-1)),await(0,o.ff)({id:e.product._id,basketId:t})}catch(_){console.log(_)}})(s,a,t))}),[a]);return(0,b.jsxs)("div",{className:"items-basket__product",children:[(0,b.jsx)("div",{className:"items-basket__image-flex",children:(0,b.jsx)("div",{className:"items-basket__image-cover",children:(0,b.jsx)("div",{className:"items-basket__image",children:(0,b.jsx)("img",{src:"".concat(k.T5,"/").concat(s.product.name,"/").concat(JSON.parse(s.product.images)[0]),alt:""})})})}),(0,b.jsxs)("div",{className:"items-basket__info",children:[(0,b.jsx)("div",{className:"items-basket__name",children:s.product.name}),(0,b.jsx)("div",{className:"items-basket__brand",children:s.product.brand.name})]}),(0,b.jsxs)("div",{className:"items-basket__price",children:[s.product.price," \u0420"]}),(0,b.jsx)("div",{className:"items-basket__amount amount-basket",children:(0,b.jsx)(_,{value:a,change:l,classAmount:"basket"})}),(0,b.jsxs)("div",{className:"items-basket__total",children:[s.product.price*a," \u0420"]}),(0,b.jsx)("div",{onClick:h,className:"items-basket__delete _icon-delete"})]})},j=(0,i.memo)(h);var x=t(255),v=t(6674);const p=()=>{const{user:e}=(0,r.C)((e=>e.reducer.catalog)),{basket:s}=(0,r.C)((e=>e.reducer.basket)),{setSumPrice:t}=n.basketSlice.actions,a=(0,r.T)();return(0,i.useEffect)((()=>{const e=s.basketItems.reduce(((e,s)=>s.product.price*s.count+e),0);a(t(e))}),[]),(0,b.jsx)("div",{className:"items-basket__body",children:(0,b.jsx)(x.Z,{className:"todo-list",children:s.basketItems.map((s=>(0,b.jsx)(v.Z,{timeout:300,classNames:"item",children:(0,b.jsx)(j,{basketItem:s,basketId:e.basket})},s._id)))})})};var N=t(7181);const f=()=>{const{sumPrice:e}=(0,r.C)((e=>e.reducer.basket)),s=(0,r.T)(),t=(0,i.useCallback)((()=>{s((async e=>{const s=u.h.getState(),{user:t}=s.reducer.catalog,{sumPrice:a,products:c}=s.reducer.basket,{setProducts:i}=m.navbarSlice.actions,{setLoad:r}=n.basketSlice.actions;try{e(r(!0)),e(i(0));const s=await(0,o.fk)({id:t.id});let n=[];for(const e of s.basketItems)n=[...n,{[e.product._id]:e.count}];await(0,o.fS)({ordersId:t.orders,price:a,products:JSON.stringify(n)});for(const e of c)await(0,d.m)({id:Object.keys(e)[0],purchase:1});await(0,o.xY)({id:t.basket}),window.location.replace(l.Kt)}catch(k){console.log(k)}}))}),[]);return(0,b.jsxs)("div",{className:"BottomItems__bottom",children:[(0,b.jsx)("div",{className:"BottomItems__submit",children:(0,b.jsx)(N.Z,{onClick:t,className:"BottomItems__buttonCart",children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})}),(0,b.jsxs)("div",{className:"BottomItems__totalPriceBasket",children:[(0,b.jsx)("div",{className:"BottomItems__left",children:"\u0418\u0442\u043e\u0433\u043e:"}),(0,b.jsxs)("div",{className:"BottomItems__right",children:[e," \u0420"]})]})]})},g=["\u0424\u043e\u0442\u043e","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435","\u0426\u0435\u043d\u0430","\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e","\u0418\u0442\u043e\u0433\u043e"],I=()=>(0,b.jsx)("div",{className:"items-basket__top top-basket",children:g.map((e=>(0,b.jsx)("div",{className:"top-basket__item",children:e},e)))}),S=()=>(0,b.jsxs)("div",{className:"Basket__items items-basket",children:[(0,b.jsx)(I,{}),(0,b.jsx)(p,{}),(0,b.jsx)(f,{})]}),y=()=>(0,b.jsxs)("div",{className:"Basket__topic",children:[(0,b.jsx)("div",{className:"Basket__title",children:"\u041a\u043e\u0440\u0437\u0438\u043d\u0430"}),(0,b.jsx)(S,{})]});var B=t(77);const C=()=>{const{basket:e,load:s}=(0,r.C)((e=>e.reducer.basket)),t=(0,r.T)();return(0,i.useEffect)((()=>{t((async e=>{const s=u.h.getState(),{user:t}=s.reducer.catalog,{setProducts:a,setBasket:c,setLoad:i}=n.basketSlice.actions;try{e(i(!0));const s=await(0,o.fk)({id:t.id});e(c(s));let r=[];for(const e of s.basketItems)r=[...r,{[e.product._id]:e.count}];e(a(r))}catch(r){console.log(r)}finally{e(i(!1))}}))}),[]),(0,b.jsx)(b.Fragment,{children:s?(0,b.jsx)(B.Z,{}):e&&0!==e.basketItems.length?(0,b.jsx)(y,{}):(0,b.jsx)("div",{className:"Basket__none _icon-cart",children:"\u043d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"})})},w=()=>(0,b.jsx)("div",{className:"Basket",children:(0,b.jsx)("div",{className:"Basket__container",children:(0,b.jsxs)("div",{className:"Basket__body",children:[(0,b.jsx)(c.Z,{navigationClass:"basket",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f / \u041a\u043e\u0440\u0437\u0438\u043d\u0430"}),(0,b.jsx)(C,{})]})})}),P=()=>(0,b.jsx)(a.Z,{children:(0,b.jsx)(w,{})})},7462:(e,s,t)=>{function a(){return a=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},a.apply(this,arguments)}t.d(s,{Z:()=>a})},3366:(e,s,t)=>{function a(e,s){if(null==e)return{};var t,a,c={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],s.indexOf(t)>=0||(c[t]=e[t]);return c}t.d(s,{Z:()=>a})}}]);
//# sourceMappingURL=361.b4b864c5.chunk.js.map